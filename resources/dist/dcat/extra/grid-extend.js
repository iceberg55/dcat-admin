(()=>{"use strict";function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t(e)}function e(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,r(i.key),i)}}function r(e){var r=function(e,r){if("object"!=t(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,r||"default");if("object"!=t(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(e)}(e,"string");return"symbol"==t(r)?r:String(r)}var n=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var r,n,i;return r=t,(n=[{key:"getChildren",value:function(t,e){var r,n=this,i=[],o=!1;return t.each((function(t,a){n.isTr(a)&&!o&&(r||(r=$(a)),r&&!n.isChildren(e,r)||(n.isChildren(e,a)?i.push(a):o=!0))})),i}},{key:"swapable",value:function(t,e){if(t&&t.length&&e===this.getDepth(t))return!0}},{key:"sibling",value:function(t,e){var r,n=this;return t.each((function(t,i){n.getDepth(i)===e&&!r&&n.isTr(i)&&(r=$(i))})),r}},{key:"isChildren",value:function(t,e){return this.getDepth(e)>this.getDepth(t)}},{key:"getDepth",value:function(t){return parseInt($(t).data("depth")||0)}},{key:"isTr",value:function(t){return"tr"===$(t).prop("tagName").toLocaleLowerCase()}}])&&e(r.prototype,n),i&&e(r,i),Object.defineProperty(r,"prototype",{writable:!1}),t}();function i(t){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i(t)}function o(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,a(n.key),n)}}function a(t){var e=function(t,e){if("object"!=i(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=i(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==i(e)?e:String(e)}var l=function(){function t(e,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.options=$.extend({button:null,table:null,url:"",perPage:"",showNextPage:"",pageQueryName:"",parentIdQueryName:"",depthQueryName:"",showIcon:"fa-angle-right",hideIcon:"fa-angle-down",loadMoreIcon:'<i class="feather icon-more-horizontal"></i>'},r),this.helper=e,this.key=this.depth=this.row=this.data=this._req=null,this._init()}var e,r,n;return e=t,(r=[{key:"_init",value:function(){var t=this,e=t.options;$(e.button).off("click").click((function(){if(!t._req){var r=$(this),n=$("i",this),i=n.hasClass(e.showIcon);t.key=r.data("key"),t.depth=r.data("depth"),t.row=r.closest("tr"),"0"==r.data("inserted")&&(t.request(1),r.data("inserted",1)),n.toggleClass(e.showIcon+" "+e.hideIcon);var o=[];t.helper.getChildren(t.row.nextAll(),t.row).forEach((function(e){t.helper.getDepth(e)===t.depth+1&&(o.push(e),i?$(e).show():$(e).hide())})),o.forEach((function(r){if(!i){var n=$(r).find("a[data-depth="+t.helper.getDepth(r)+"] i");n.hasClass(e.hideIcon)&&n.parent().click()}}))}}))}},{key:"request",value:function(t,e){var r=this,n=r.row,i=r.key,o=r.depth,a=r.options.table;if(!r._req){r._req=1,Dcat.loading();var l={};l[r.options.parentIdQueryName]=i,l[r.options.depthQueryName]=o+1,l[r.options.pageQueryName.replace(":key",i)]=t,$.ajax({url:r.options.url,type:"GET",data:l,headers:{"X-PJAX":!0},success:function(i){e&&e(),Dcat.loading(!1),r._req=0;var l=r.helper.getChildren(n.nextAll(),n);n=l.length?$(l.pop()):n;var u=$("<div>"+i+"</div>"),c=u.find(a+" tbody"),f=u.find("last-page").text(),s=u.find("next-page").text();if(c.find("tr").each((function(t,e){$(e).attr("data-depth",o+1)})),r.options.showNextPage&&c.find("tr").length==r.options.perPage&&f>=t){var p=$('<tr data-depth="'.concat(o+1,'" data-page="').concat(s,'">\n                                <td colspan="').concat(n.find("td").length,'" align="center" style="cursor: pointer">\n                                    <a href="#" style="font-size: 1.5rem">').concat(r.options.loadMoreIcon,"</a>\n                                </td>\n                            </tr>"));n.after(p),p.click((function(){var t=$(this);r.request(t.data("page"),(function(){t.remove()}))}))}n.after(c.html()),u.find("script").each((function(t,e){n.after(e)})),$("body .extra-html").append(u.find(".extra-html").html()),Dcat.triggerReady()},error:function(t,n,i){e&&e(),Dcat.loading(!1),r._req=0,404!=t.status&&Dcat.handleAjaxError(t,n,i)}})}}}])&&o(e.prototype,r),n&&o(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function u(t){return u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},u(t)}function c(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,f(n.key),n)}}function f(t){var e=function(t,e){if("object"!=u(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=u(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==u(e)?e:String(e)}var s=function(){function t(e,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.options=$.extend({button:null,url:""},r),this.helper=e,this.direction=this.key=this.depth=this.row=this._req=null,this._init()}var e,r,n;return e=t,(r=[{key:"_init",value:function(){var t=this;$(t.options.button).off("click").click((function(){if(!t._req){t._req=1,Dcat.loading();var e=$(this);t.key=e.data("id"),t.direction=e.data("direction"),t.row=e.closest("tr"),t.depth=t.helper.getDepth(t.row),t.request()}}))}},{key:"request",value:function(){var t=this,e=t.helper,r=t.key,n=t.row,i=t.depth,o=t.direction,a=n.prevAll(),l=n.nextAll(),u=n.prevAll("tr").first(),c=n.nextAll("tr").first();$.put({url:t.options.url.replace(":key",r),data:{_orderable:o},success:function(r){if(Dcat.loading(!1),t._req=0,!r.status)return r.data.message&&Dcat.warning(r.data.message);if(Dcat.success(r.data.message),o){var f=e.sibling(a,i);e.swapable(f,i)&&u.length&&e.getDepth(u)>=i&&(f.before(n),e.getChildren(l,n).forEach((function(t){f.before(t)})))}else{var s=e.sibling(l,i),p=s?e.getChildren(s.nextAll(),s):[];if(e.swapable(s,i)&&c.length&&e.getDepth(c)>=i){l=n.nextAll(),p.length&&(s=$(p.pop()));var h=[];e.getChildren(l,n).forEach((function(t){h.unshift(t)})),h.forEach((function(t){s.after(t)})),s.after(n)}}},error:function(e,r,n){t._req=0,Dcat.loading(!1),Dcat.handleAjaxError(e,r,n)}})}}])&&c(e.prototype,r),n&&c(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function p(t){return p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},p(t)}function h(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,d(n.key),n)}}function d(t){var e=function(t,e){if("object"!=p(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=p(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==p(e)?e:String(e)}var y=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.options=$.extend({container:".table-card"},e);var r=this;$(this.options.container).on("table:load",(function(){r.load($(this).data("url"),$(this))}))}var e,r,n;return e=t,(r=[{key:"load",value:function(t,e){var r=this;t&&(e.attr("data-current",t),e.loading({background:"transparent!important"}),Dcat.helpers.asyncRender(t,(function(t){e.loading(!1),e.html(t),r.bind(e),e.trigger("table:loaded")})))}},{key:"bind",value:function(t){var e=this;function r(){return e.load($(this).attr("href"),t),!1}t.find(".pagination .page-link").on("click",r),t.find(".grid-column-header a").on("click",r),t.find("form").on("submit",(function(){return e.load($(this).attr("action")+"&"+$(this).serialize(),t),!1})),t.find(".filter-box .reset").on("click",r),t.find(".grid-selector a").on("click",r),Dcat.ready((function(){setTimeout((function(){t.find(".grid-refresh").off("click").on("click",(function(){return e.load(t.data("current"),t),!1}))}),10)}))}}])&&h(e.prototype,r),n&&h(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();!function(t,e){var r=t.Dcat,i=new n;r.grid.Tree=function(t){return new l(i,t)},r.grid.Orderable=function(t){return new s(i,t)},r.grid.AsyncTable=function(t){return new y(t)}}(window,jQuery)})();
//# sourceMappingURL=grid-extend.js.map